@page "/BattleshipGame"
@using Battleship.Game
@using Battleship.Model
@using Battleship.Shared
@inject HttpClient Http
@inject IEngine Engine

<PageTitle>Battleship Game</PageTitle>

@if (squares == null)
{
    <p><em>Loading...</em></p>
}
else
{
    <GameGrid squares=squares size=size></GameGrid>

    <br />
    <input type="text" @bind-value="coords">
    <input type="button" disabled=@(stillInGame == false) value="Shot" @onclick=OnClick>

    <br />
    <input type="text" hidden=@stillInGame value="FINISH"/>
}

@code {
    SquareState[,] squares = null;
    int size = 10; // todo get from grid
    private string coords = string.Empty;
    bool stillInGame = true;

    protected override async Task OnInitializedAsync()
    {
        squares = Engine.CraeteGrid();

        //forecasts = await Http.GetFromJsonAsync<WeatherForecast[]>("WeatherForecast");
    }

    public async Task OnClick() 
    {
        squares = Engine.Shot(coords);
        coords = string.Empty;
        stillInGame = !Engine.HasGameEnded();
        StateHasChanged();
        
    }
}
